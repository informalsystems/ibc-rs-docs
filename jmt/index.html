<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="This module implements `JellyfishMerkleTree` backed by storage module. The tree itself doesn’t persist anything, but realizes the logic of R/W only. The write path will produce all the intermediate results in a batch for storage layer to commit and the read path will return results directly. The public APIs are only `new`, `put_value_sets`, `put_value_set` and `get_with_proof`. After each put with a `value_set` based on a known version, the tree will return a new root hash with a `TreeUpdateBatch` containing all the new nodes and indices of stale nodes."><title>jmt - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-b0742ba02757f159.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="jmt" data-themes="" data-resource-suffix="" data-rustdoc-version="1.84.0-nightly (9322d183f 2024-10-14)" data-channel="nightly" data-search-js="search-e056c65ede92db13.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../jmt/index.html">jmt</a><span class="version">0.11.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section id="rustdoc-toc"><h3><a href="#modules">Crate Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#functions" title="Functions">Functions</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <span>jmt</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/jmt/lib.rs.html#3-364">source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>This module implements <a href="struct.JellyfishMerkleTree.html"><code>JellyfishMerkleTree</code></a> backed by storage module. The tree itself doesn’t
persist anything, but realizes the logic of R/W only. The write path will produce all the
intermediate results in a batch for storage layer to commit and the read path will return
results directly. The public APIs are only <a href="struct.JellyfishMerkleTree.html#method.new"><code>new</code></a>, <a href="struct.JellyfishMerkleTree.html#method.put_value_sets"><code>put_value_sets</code></a>, <a href="struct.JellyfishMerkleTree.html#method.put_value_set"><code>put_value_set</code></a> and
<a href="struct.JellyfishMerkleTree.html#method.get_with_proof"><code>get_with_proof</code></a>. After each put with a <code>value_set</code> based on a known version, the tree will
return a new root hash with a <a href="struct.TreeUpdateBatch.html"><code>TreeUpdateBatch</code></a> containing all the new nodes and indices of
stale nodes.</p>
<p>A Jellyfish Merkle Tree itself logically is a 256-bit sparse Merkle tree with an optimization
that any subtree containing 0 or 1 leaf node will be replaced by that leaf node or a placeholder
node with default hash value. With this optimization we can save CPU by avoiding hashing on
many sparse levels in the tree. Physically, the tree is structurally similar to the modified
Patricia Merkle tree of Ethereum but with some modifications. A standard Jellyfish Merkle tree
will look like the following figure:</p>
<div class="example-wrap"><pre class="language-text"><code>                                    .──────────────────────.
                            _.─────&#39;                        `──────.
                       _.──&#39;                                        `───.
                   _.─&#39;                                                  `──.
               _.─&#39;                                                          `──.
             ,&#39;                                                                  `.
          ,─&#39;                                                                      &#39;─.
        ,&#39;                                                                            `.
      ,&#39;                                                                                `.
     ╱                                                                                    ╲
    ╱                                                                                      ╲
   ╱                                                                                        ╲
  ╱                                                                                          ╲
 ;                                                                                            :
 ;                                                                                            :
;                                                                                              :
│                                                                                              │
+──────────────────────────────────────────────────────────────────────────────────────────────+
 .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.  .&#39;&#39;.
/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \/    \
+----++----++----++----++----++----++----++----++----++----++----++----++----++----++----++----+
 (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )
 (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )
 (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )
 (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )  )
 (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (  (
 ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■  ■

 ■: the [`Value`] type this tree stores.</code></pre></div>
<p>A Jellyfish Merkle Tree consists of <a href="node_type/struct.InternalNode.html"><code>InternalNode</code></a> and <a href="node_type/struct.LeafNode.html"><code>LeafNode</code></a>. <a href="node_type/struct.InternalNode.html"><code>InternalNode</code></a> is like
branch node in ethereum patricia merkle with 16 children to represent a 4-level binary tree and
<a href="node_type/struct.LeafNode.html"><code>LeafNode</code></a> is similar to that in patricia merkle too. In the above figure, each <code>bell</code> in the
jellyfish is an <a href="node_type/struct.InternalNode.html"><code>InternalNode</code></a> while each tentacle is a <a href="node_type/struct.LeafNode.html"><code>LeafNode</code></a>. It is noted that
Jellyfish merkle doesn’t have a counterpart for <code>extension</code> node of ethereum patricia merkle.</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="proof/index.html" title="mod jmt::proof">proof</a></div><div class="desc docblock-short">Merkle proof types.</div></li><li><div class="item-name"><a class="mod" href="restore/index.html" title="mod jmt::restore">restore</a></div><div class="desc docblock-short">This module implements the functionality to restore a
<a href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree"><code>JellyfishMerkleTree</code></a> from small chunks of
key/value pairs.</div></li><li><div class="item-name"><a class="mod" href="storage/index.html" title="mod jmt::storage">storage</a></div><div class="desc docblock-short">Contains types used to bridge a <a href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree"><code>JellyfishMerkleTree</code></a>
to the backing storage recording the tree’s internal data.</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.JellyfishMerkleIterator.html" title="struct jmt::JellyfishMerkleIterator">Jellyfish<wbr>Merkle<wbr>Iterator</a></div><div class="desc docblock-short">An iterator over all key-value pairs in a <a href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree"><code>JellyfishMerkleTree</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree">Jellyfish<wbr>Merkle<wbr>Tree</a></div><div class="desc docblock-short">A Jellyfish Merkle tree data structure, parameterized by a <a href="storage/trait.TreeReader.html" title="trait jmt::storage::TreeReader"><code>TreeReader</code></a> <code>R</code>
and a <a href="trait.SimpleHasher.html" title="trait jmt::SimpleHasher"><code>SimpleHasher</code></a> <code>H</code>. See <a href="index.html" title="mod jmt"><code>crate</code></a> for description.</div></li><li><div class="item-name"><a class="struct" href="struct.KeyHash.html" title="struct jmt::KeyHash">KeyHash</a></div><div class="desc docblock-short">A hashed key used to index a <a href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree"><code>JellyfishMerkleTree</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.MissingRootError.html" title="struct jmt::MissingRootError">Missing<wbr>Root<wbr>Error</a></div><div class="desc docblock-short">An error that occurs when the state root for a requested version is missing (e.g., because it was pruned).</div></li><li><div class="item-name"><a class="struct" href="struct.RootHash.html" title="struct jmt::RootHash">Root<wbr>Hash</a></div><div class="desc docblock-short">A root of a <a href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree"><code>JellyfishMerkleTree</code></a>.</div></li><li><div class="item-name"><a class="struct" href="struct.TransparentHasher.html" title="struct jmt::TransparentHasher">Transparent<wbr>Hasher</a></div><div class="desc docblock-short">A trivial implementation of <a href="trait.SimpleHasher.html" title="trait jmt::SimpleHasher"><code>SimpleHasher</code></a> that simply returns the first 32 bytes of the
provided data. This is useful to avoid hashing data when testing, and facilitate debugging
specific tree configurations.</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.SimpleHasher.html" title="trait jmt::SimpleHasher">Simple<wbr>Hasher</a></div><div class="desc docblock-short">A minimal trait representing a hash function. We implement our own
rather than relying on <code>Digest</code> for broader compatibility.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.ics23_spec.html" title="fn jmt::ics23_spec">ics23_<wbr>spec</a></div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.OwnedValue.html" title="type jmt::OwnedValue">Owned<wbr>Value</a></div><div class="desc docblock-short">An owned value stored in the <a href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree"><code>JellyfishMerkleTree</code></a>.</div></li><li><div class="item-name"><a class="type" href="type.Sha256Jmt.html" title="type jmt::Sha256Jmt">Sha256<wbr>Jmt</a></div><div class="desc docblock-short">A <a href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree"><code>JellyfishMerkleTree</code></a> instantiated using the <code>sha2::Sha256</code> hasher.
This is a sensible default choice for most applications.</div></li><li><div class="item-name"><a class="type" href="type.Version.html" title="type jmt::Version">Version</a></div><div class="desc docblock-short">Specifies a particular version of the <a href="struct.JellyfishMerkleTree.html" title="struct jmt::JellyfishMerkleTree"><code>JellyfishMerkleTree</code></a> state.</div></li></ul></section></div></main></body></html>