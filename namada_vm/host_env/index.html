<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Virtual machine’s host environment exposes functions that may be called from within a virtual machine."><title>namada_vm::host_env - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-b0742ba02757f159.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="namada_vm" data-themes="" data-resource-suffix="" data-rustdoc-version="1.84.0-nightly (9322d183f 2024-10-14)" data-channel="nightly" data-search-js="search-e056c65ede92db13.js" data-settings-js="settings-805db61a62df4bd2.js" ><script src="../../static.files/storage-1d39b6787ed640ff.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-f070b9041d14864c.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-0111fcff984fae8f.css"></noscript><link rel="icon" href="https://dev.namada.net/master/favicon.png"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../namada_vm/index.html"><img src="https://dev.namada.net/master/rustdoc-logo.png" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../namada_vm/index.html"><img src="https://dev.namada.net/master/rustdoc-logo.png" alt="logo"></a><h2><a href="../../namada_vm/index.html">namada_<wbr>vm</a><span class="version">0.46.1</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module host_<wbr>env</a></h2><h3><a href="#structs">Module Items</a></h3><ul class="block"><li><a href="#structs" title="Structs">Structs</a></li><li><a href="#enums" title="Enums">Enums</a></li><li><a href="#traits" title="Traits">Traits</a></li><li><a href="#functions" title="Functions">Functions</a></li><li><a href="#types" title="Type Aliases">Type Aliases</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate namada_<wbr>vm</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../index.html">namada_vm</a></span><h1>Module <span>host_env</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/namada_vm/host_env.rs.html#1-2474">source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Virtual machine’s host environment exposes functions that may be called from
within a virtual machine.</p>
</div></details><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.TxCtx.html" title="struct namada_vm::host_env::TxCtx">TxCtx</a></div><div class="desc docblock-short">A transaction’s host context</div></li><li><div class="item-name"><a class="struct" href="struct.TxVmEnv.html" title="struct namada_vm::host_env::TxVmEnv">TxVmEnv</a></div><div class="desc docblock-short">A transaction’s host environment</div></li><li><div class="item-name"><a class="struct" href="struct.VpCtx.html" title="struct namada_vm::host_env::VpCtx">VpCtx</a></div><div class="desc docblock-short">A validity predicate’s host context</div></li><li><div class="item-name"><a class="struct" href="struct.VpVmEnv.html" title="struct namada_vm::host_env::VpVmEnv">VpVmEnv</a></div><div class="desc docblock-short">A validity predicate’s host environment</div></li></ul><h2 id="enums" class="section-header">Enums<a href="#enums" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="enum" href="enum.Error.html" title="enum namada_vm::host_env::Error">Error</a></div></li><li><div class="item-name"><a class="enum" href="enum.TxRuntimeError.html" title="enum namada_vm::host_env::TxRuntimeError">TxRuntime<wbr>Error</a></div><div class="desc docblock-short">These runtime errors will abort tx WASM execution immediately</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.VpEvaluator.html" title="trait namada_vm::host_env::VpEvaluator">VpEvaluator</a></div><div class="desc docblock-short">A Validity predicate runner for calls from the <a href="fn.vp_eval.html" title="fn namada_vm::host_env::vp_eval"><code>vp_eval</code></a> function.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.tx_charge_gas.html" title="fn namada_vm::host_env::tx_charge_gas">tx_<wbr>charge_<wbr>gas</a></div><div class="desc docblock-short">Add a gas cost incured in a transaction</div></li><li><div class="item-name"><a class="fn" href="fn.tx_delete.html" title="fn namada_vm::host_env::tx_delete">tx_<wbr>delete</a></div><div class="desc docblock-short">Storage delete function exposed to the wasm VM Tx environment. The given
key/value will be written as deleted to the write log.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_emit_event.html" title="fn namada_vm::host_env::tx_emit_event">tx_<wbr>emit_<wbr>event</a></div><div class="desc docblock-short">Expose the functionality to emit events to the wasm VM’s Tx environment.
An emitted event will land in the write log.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_get_block_epoch.html" title="fn namada_vm::host_env::tx_get_block_epoch">tx_<wbr>get_<wbr>block_<wbr>epoch</a></div><div class="desc docblock-short">Getting the block epoch function exposed to the wasm VM Tx
environment. The epoch is that of the block to which the current
transaction is being applied.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_get_block_header.html" title="fn namada_vm::host_env::tx_get_block_header">tx_<wbr>get_<wbr>block_<wbr>header</a></div><div class="desc docblock-short">Getting the block header function exposed to the wasm VM Tx environment.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_get_block_height.html" title="fn namada_vm::host_env::tx_get_block_height">tx_<wbr>get_<wbr>block_<wbr>height</a></div><div class="desc docblock-short">Getting the block height function exposed to the wasm VM Tx
environment. The height is that of the block to which the current
transaction is being applied.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_get_chain_id.html" title="fn namada_vm::host_env::tx_get_chain_id">tx_<wbr>get_<wbr>chain_<wbr>id</a></div><div class="desc docblock-short">Getting the chain ID function exposed to the wasm VM Tx environment.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_get_events.html" title="fn namada_vm::host_env::tx_get_events">tx_<wbr>get_<wbr>events</a></div><div class="desc docblock-short">Expose the functionality to query events from the wasm VM’s Tx environment.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_get_native_token.html" title="fn namada_vm::host_env::tx_get_native_token">tx_<wbr>get_<wbr>native_<wbr>token</a></div><div class="desc docblock-short">Get the native token’s address</div></li><li><div class="item-name"><a class="fn" href="fn.tx_get_pred_epochs.html" title="fn namada_vm::host_env::tx_get_pred_epochs">tx_<wbr>get_<wbr>pred_<wbr>epochs</a></div><div class="desc docblock-short">Get predecessor epochs function exposed to the wasm VM Tx environment.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_get_tx_index.html" title="fn namada_vm::host_env::tx_get_tx_index">tx_<wbr>get_<wbr>tx_<wbr>index</a></div><div class="desc docblock-short">Getting the transaction index function exposed to the wasm VM Tx
environment. The index is that of the transaction being applied
in the current block.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_has_key.html" title="fn namada_vm::host_env::tx_has_key">tx_<wbr>has_<wbr>key</a></div><div class="desc docblock-short">Storage <code>has_key</code> function exposed to the wasm VM Tx environment. It will
try to check the write log first and if no entry found then the storage.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_init_account.html" title="fn namada_vm::host_env::tx_init_account">tx_<wbr>init_<wbr>account</a></div><div class="desc docblock-short">Initialize a new account established address.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_insert_verifier.html" title="fn namada_vm::host_env::tx_insert_verifier">tx_<wbr>insert_<wbr>verifier</a></div><div class="desc docblock-short">Verifier insertion function exposed to the wasm VM Tx environment.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_iter_next.html" title="fn namada_vm::host_env::tx_iter_next">tx_<wbr>iter_<wbr>next</a></div><div class="desc docblock-short">Storage prefix iterator next function exposed to the wasm VM Tx environment.
It will try to read from the write log first and if no entry found then from
the storage.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_iter_prefix.html" title="fn namada_vm::host_env::tx_iter_prefix">tx_<wbr>iter_<wbr>prefix</a></div><div class="desc docblock-short">Storage prefix iterator function exposed to the wasm VM Tx environment.
It will try to get an iterator from the storage and return the corresponding
ID of the iterator, ordered by storage keys.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_log_string.html" title="fn namada_vm::host_env::tx_log_string">tx_<wbr>log_<wbr>string</a></div><div class="desc docblock-short">Log a string from exposed to the wasm VM Tx environment. The message will be
printed at the <a href="../../tracing_core/metadata/struct.Level.html#associatedconstant.INFO" title="associated constant tracing_core::metadata::Level::INFO"><code>tracing::Level::INFO</code></a>. This function is for development
only.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_read.html" title="fn namada_vm::host_env::tx_read">tx_read</a></div><div class="desc docblock-short">Storage read function exposed to the wasm VM Tx environment. It will try to
read from the write log first and if no entry found then from the storage.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_read_temp.html" title="fn namada_vm::host_env::tx_read_temp">tx_<wbr>read_<wbr>temp</a></div><div class="desc docblock-short">Read temporary value (not committed to storage) from the given key function
exposed to the wasm VM Tx environment. It will try to read from the write
log only.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_result_buffer.html" title="fn namada_vm::host_env::tx_result_buffer">tx_<wbr>result_<wbr>buffer</a></div><div class="desc docblock-short">This function is a helper to handle the first step of reading var-len
values from the host.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_set_commitment_sentinel.html" title="fn namada_vm::host_env::tx_set_commitment_sentinel">tx_<wbr>set_<wbr>commitment_<wbr>sentinel</a></div><div class="desc docblock-short">Set the sentinel for an invalid tx section commitment</div></li><li><div class="item-name"><a class="fn" href="fn.tx_update_masp_note_commitment_tree.html" title="fn namada_vm::host_env::tx_update_masp_note_commitment_tree">tx_<wbr>update_<wbr>masp_<wbr>note_<wbr>commitment_<wbr>tree</a></div><div class="desc docblock-short">Appends the new note commitments to the tree in storage</div></li><li><div class="item-name"><a class="fn" href="fn.tx_update_validity_predicate.html" title="fn namada_vm::host_env::tx_update_validity_predicate">tx_<wbr>update_<wbr>validity_<wbr>predicate</a></div><div class="desc docblock-short">Update a validity predicate function exposed to the wasm VM Tx environment</div></li><li><div class="item-name"><a class="fn" href="fn.tx_verify_tx_section_signature.html" title="fn namada_vm::host_env::tx_verify_tx_section_signature">tx_<wbr>verify_<wbr>tx_<wbr>section_<wbr>signature</a></div><div class="desc docblock-short">Verify a transaction signature</div></li><li><div class="item-name"><a class="fn" href="fn.tx_write.html" title="fn namada_vm::host_env::tx_write">tx_<wbr>write</a></div><div class="desc docblock-short">Storage write function exposed to the wasm VM Tx environment. The given
key/value will be written to the write log.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_write_temp.html" title="fn namada_vm::host_env::tx_write_temp">tx_<wbr>write_<wbr>temp</a></div><div class="desc docblock-short">Temporary storage write function exposed to the wasm VM Tx environment. The
given key/value will be written only to the write log. It will be never
written to the storage.</div></li><li><div class="item-name"><a class="fn" href="fn.tx_yield_value.html" title="fn namada_vm::host_env::tx_yield_value">tx_<wbr>yield_<wbr>value</a></div><div class="desc docblock-short">Yield a byte array value from the guest.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_charge_gas.html" title="fn namada_vm::host_env::vp_charge_gas">vp_<wbr>charge_<wbr>gas</a></div><div class="desc docblock-short">Called from VP wasm to request to use the given gas amount</div></li><li><div class="item-name"><a class="fn" href="fn.vp_eval.html" title="fn namada_vm::host_env::vp_eval">vp_eval</a></div><div class="desc docblock-short">Evaluate a validity predicate with the given input data.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_block_epoch.html" title="fn namada_vm::host_env::vp_get_block_epoch">vp_<wbr>get_<wbr>block_<wbr>epoch</a></div><div class="desc docblock-short">Getting the block epoch function exposed to the wasm VM VP
environment. The epoch is that of the block to which the current
transaction is being applied.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_block_header.html" title="fn namada_vm::host_env::vp_get_block_header">vp_<wbr>get_<wbr>block_<wbr>header</a></div><div class="desc docblock-short">Getting the block header function exposed to the wasm VM VP environment.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_block_height.html" title="fn namada_vm::host_env::vp_get_block_height">vp_<wbr>get_<wbr>block_<wbr>height</a></div><div class="desc docblock-short">Getting the block height function exposed to the wasm VM VP
environment. The height is that of the block to which the current
transaction is being applied.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_chain_id.html" title="fn namada_vm::host_env::vp_get_chain_id">vp_<wbr>get_<wbr>chain_<wbr>id</a></div><div class="desc docblock-short">Getting the chain ID function exposed to the wasm VM VP environment.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_events.html" title="fn namada_vm::host_env::vp_get_events">vp_<wbr>get_<wbr>events</a></div><div class="desc docblock-short">Expose the functionality to query events from the wasm VM’s VP environment.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_native_token.html" title="fn namada_vm::host_env::vp_get_native_token">vp_<wbr>get_<wbr>native_<wbr>token</a></div><div class="desc docblock-short">Get the native token’s address</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_pred_epochs.html" title="fn namada_vm::host_env::vp_get_pred_epochs">vp_<wbr>get_<wbr>pred_<wbr>epochs</a></div><div class="desc docblock-short">Get predecessor epochs function exposed to the wasm VM VP environment.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_tx_code_hash.html" title="fn namada_vm::host_env::vp_get_tx_code_hash">vp_<wbr>get_<wbr>tx_<wbr>code_<wbr>hash</a></div><div class="desc docblock-short">Getting the transaction hash function exposed to the wasm VM VP environment.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_get_tx_index.html" title="fn namada_vm::host_env::vp_get_tx_index">vp_<wbr>get_<wbr>tx_<wbr>index</a></div><div class="desc docblock-short">Getting the block height function exposed to the wasm VM VP
environment. The height is that of the block to which the current
transaction is being applied.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_has_key_post.html" title="fn namada_vm::host_env::vp_has_key_post">vp_<wbr>has_<wbr>key_<wbr>post</a></div><div class="desc docblock-short">Storage <code>has_key</code> in posterior state (after tx execution) function exposed
to the wasm VM VP environment. It will try to check the write log first and
if no entry found then the storage.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_has_key_pre.html" title="fn namada_vm::host_env::vp_has_key_pre">vp_<wbr>has_<wbr>key_<wbr>pre</a></div><div class="desc docblock-short">Storage <code>has_key</code> in prior state (before tx execution) function exposed to
the wasm VM VP environment. It will try to read from the storage.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_iter_next.html" title="fn namada_vm::host_env::vp_iter_next">vp_<wbr>iter_<wbr>next</a></div><div class="desc docblock-short">Storage prefix iterator for prior or posterior state function
exposed to the wasm VM VP environment.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_iter_prefix_post.html" title="fn namada_vm::host_env::vp_iter_prefix_post">vp_<wbr>iter_<wbr>prefix_<wbr>post</a></div><div class="desc docblock-short">Storage prefix iterator function for posterior state (after tx execution)
exposed to the wasm VM VP environment.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_iter_prefix_pre.html" title="fn namada_vm::host_env::vp_iter_prefix_pre">vp_<wbr>iter_<wbr>prefix_<wbr>pre</a></div><div class="desc docblock-short">Storage prefix iterator function for prior state (before tx execution)
exposed to the wasm VM VP environment.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_log_string.html" title="fn namada_vm::host_env::vp_log_string">vp_<wbr>log_<wbr>string</a></div><div class="desc docblock-short">Log a string from exposed to the wasm VM VP environment. The message will be
printed at the <a href="../../tracing_core/metadata/struct.Level.html#associatedconstant.INFO" title="associated constant tracing_core::metadata::Level::INFO"><code>tracing::Level::INFO</code></a>. This function is for development
only.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_read_post.html" title="fn namada_vm::host_env::vp_read_post">vp_<wbr>read_<wbr>post</a></div><div class="desc docblock-short">Storage read posterior state (after tx execution) function exposed to the
wasm VM VP environment. It will try to read from the write log first and if
no entry found then from the storage.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_read_pre.html" title="fn namada_vm::host_env::vp_read_pre">vp_<wbr>read_<wbr>pre</a></div><div class="desc docblock-short">Storage read prior state (before tx execution) function exposed to the wasm
VM VP environment. It will try to read from the storage.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_read_temp.html" title="fn namada_vm::host_env::vp_read_temp">vp_<wbr>read_<wbr>temp</a></div><div class="desc docblock-short">Storage read temporary state (after tx execution) function exposed to the
wasm VM VP environment. It will try to read from only the write log.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_result_buffer.html" title="fn namada_vm::host_env::vp_result_buffer">vp_<wbr>result_<wbr>buffer</a></div><div class="desc docblock-short">This function is a helper to handle the first step of reading var-len
values from the host.</div></li><li><div class="item-name"><a class="fn" href="fn.vp_verify_tx_section_signature.html" title="fn namada_vm::host_env::vp_verify_tx_section_signature">vp_<wbr>verify_<wbr>tx_<wbr>section_<wbr>signature</a></div><div class="desc docblock-short">Verify a transaction signature in the host environment for better
performance</div></li><li><div class="item-name"><a class="fn" href="fn.vp_yield_value.html" title="fn namada_vm::host_env::vp_yield_value">vp_<wbr>yield_<wbr>value</a></div><div class="desc docblock-short">Yield a byte array value from the guest.</div></li></ul><h2 id="types" class="section-header">Type Aliases<a href="#types" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="type" href="type.Result.html" title="type namada_vm::host_env::Result">Result</a></div><div class="desc docblock-short">Result of a storage API call.</div></li><li><div class="item-name"><a class="type" href="type.TxResult.html" title="type namada_vm::host_env::TxResult">TxResult</a></div><div class="desc docblock-short">Result of a tx host env fn call</div></li></ul></section></div></main></body></html>